/* @license
 * proparty.js v0.1.0
 * http://jschr.github.com/proparty
 * MIT licensed
 *
 * Copyright (C) 2012-2013 Jordan Schroter
 */
!function(t){"use strict";function e(t,e){Object.keys(t).forEach(function(i){e(i,t[i])})}function i(t,e){var i={};return e=e||function(e){return t[e]},Object.keys(t).forEach(function(n){var s=e(n,t[n]);"undefined"!=typeof s&&(i[n]=s)}),i}function n(t,e,i){return"function"==typeof t?t.call(e,i):t}var s=function(){var t=window.getComputedStyle(document.documentElement,""),e=(Array.prototype.slice.call(t).join("").match(/-(moz|webkit|ms|o)-/)||""===t.OLink&&["","o"])[1],i="WebKit|Moz|MS|O".match(new RegExp("("+e+")","i"))[1];return{dom:i,lowercase:e,css:"-"+e+"-",js:e[0].toUpperCase()+e.substr(1)}}(),r=function(){this.store={}};r.prototype={id:function(t){var e=t.getAttribute("data-propartyid");return e||(e=Date.now(),t.setAttribute("data-propartyid",e)),e},set:function(t,e,i,n){var s=this.id(t);this.store[s]||(this.store[s]={}),this.store[s][e]||(this.store[s][e]={}),this.store[s][e][i]=n},get:function(t,e,n){var s=this.id(t),r=this.store[s];return e?(r=r[e],n&&(r=r[n])):n&&(r=i(r,function(t,e){return e[n]})),r},clear:function(t){var e=this.id(t);t.removeAttribute("data-propartyid"),delete this.store[e]}};var a=new r,o=0,u=function(t,e){this.init(t,e)};u.prototype={constructor:u,init:function(t,e){e=e||{},this.element=t,this.properties={},this.transforms={},this.animations={},this.callbacks={},this.settings={},this.next=[],this.inc=0,this.uuid=o++,this.paused=!1,e&&this.setSettings(e),this.executeCallback("initialized")},setSettings:function(t){return this.settings.duration="undefined"!=typeof t.duration?t.duration:c.defaults.duration,this.settings.delay="undefined"!=typeof t.delay?t.delay:c.defaults.delay,this.settings.initialDelay="undefined"!=typeof t.initialDelay?t.initialDelay:c.defaults.initialDelay,this.settings.ease="undefined"!=typeof t.ease?t.ease:c.defaults.ease,this.settings.cycle="undefined"!=typeof t.cycle?t.cycle:c.defaults.cycle,this.settings.preserve="undefined"!=typeof t.preserve?t.preserve:c.defaults.preserve,this},setDuration:function(t){return this.setSettings({duration:t})},setDelay:function(t){return this.setSettings({delay:t})},setCycle:function(t){return this.setSettings({cycle:t})},setInitialDelay:function(t){return this.setSettings({initialDelay:t})},setEase:function(t){return this.setSettings({ease:t})},set:function(t,e){return this.properties[t]=e,this},transform:function(t,e){return this.transforms[t]=e,this},animate:function(t){return this.animations[t]=!0,this},setWithVendor:function(t,e){return this.set(s.css+t,e),this.set(t,e),this},setProperty:function(t,e){try{e||0===e?this.element.style.setProperty(t,""+e,""):this.element.style.removeProperty(t)}catch(i){console&&console.warn&&console.warn("Proparty tried setting invalid property: "+t+", value:"+e)}return this},setVendorProperty:function(t,e){return this.setProperty(s.css+t,e),this.setProperty(t,e),this},getTransition:function(t){return t+" "+(this.settings.duration/1e3+"s")+" "+c.ease[this.settings.ease]},getTransform:function(t,e){return t+"("+("string"==typeof e?e:e.join(","))+")"},getAnimation:function(t){return t+" "+(this.settings.duration/1e3+"s")+" "+c.ease[this.settings.ease]},getValue:function(t,e){var i,s="function"==typeof e?0:this.inc,e=[].concat(e);return"number"==typeof this.settings.cycle?this.settings.cycle>this.inc&&(i=n(e[s%e.length],this,t)):i="boolean"==typeof this.settings.cycle&&this.settings.cycle?n(e[s%e.length],this):n(e[s],this,t),i},addCallback:function(t,e){return"undefined"==typeof this.callbacks[t]&&(this.callbacks[t]=[]),this.callbacks[t].push(e),this},removeCallback:function(t){return this.callbacks[t]=this.callbacks[t].filter(function(t){return t!==t}),this},executeCallback:function(t){var e=this;this.callbacks[t]&&this.callbacks[t].map(function(t){t.call(e)})},whenInitialized:function(t){return this.addCallback("initialized",t)},whenStarted:function(t){return this.addCallback("started",t)},whenPaused:function(t){return this.addCallback("paused",t)},whenStopped:function(t){return this.addCallback("stopped",t)},whenDestroyed:function(t){return this.addCallback("destroy",t)},nextInChain:function(){var t=this;if(this.next.length){var e=t.next.shift()();e.whenDestroyed(function(){e.next.length?e.nextInChain():t.nextInChain()}).start()}else this.destroy()},start:function(){var t=this;this.paused=!1;var n=function(){var r=i(t.properties,t.getValue.bind(t)),o=i(t.transforms,t.getValue.bind(t)),u=i(t.animations,t.getValue.bind(t));if(!Object.keys(r).length&&!Object.keys(o).length&&!Object.keys(u).length)return t.stop(),t.nextInChain(),void 0;var l=[];e(u,function(e,i){l.push(t.getAnimation(e,i))});var h=[];e(o,function(e,i){h.push(t.getTransform(e,i))});var d=[];e(r,function(e){d.push(t.getTransition(e))}),h.length&&d.push(t.getTransition(s.css+"transform")),a.set(t.element,t.uuid,"transitions",d),a.set(t.element,t.uuid,"animations",l);var p=[];e(a.get(t.element,null,"transitions"),function(t,e){Array.prototype.push.apply(p,e)});var f=[];e(a.get(t.element,null,"animations"),function(t,e){Array.prototype.push.apply(f,e)}),e(r,t.setProperty.bind(t)),t.setVendorProperty("transform",h.join(" ")),t.setVendorProperty("transition",p.join(",")),t.setVendorProperty("animation",f.join(",")),c.forceHardwareAcceleration&&t.setProperty("-webkit-backface-visibility","hidden"),setTimeout(function(){setTimeout(function(){t.paused||(t.inc=(t.inc+1)%Number.MAX_VALUE,n())},t.settings.delay)},t.settings.duration)};return setTimeout(function(){n()},t.settings.initialDelay),t.executeCallback("started"),{start:t.start.bind(t),pause:t.pause.bind(t),stop:t.stop.bind(t),destroy:t.destroy.bind(t)}},pause:function(){this.paused=!0,this.executeCallback("paused")},stop:function(){this.paused=!0,this.inc=0,this.executeCallback("stopped")},chain:function(t){return this.next.push(t),this},destroy:function(){var t=this;this.paused=!0,this.inc=0,this.executeCallback("destroy"),this.settings.preserve||(t.setVendorProperty("transform",null),t.setVendorProperty("transition",null),e(this.properties,function(e){t.setProperty(e,null)})),c.forceHardwareAcceleration&&t.setProperty("-webkit-backface-visibility",null),this.properties={},this.transforms={},this.callbacks={},a.clear(this.element)}};var c=function(t,e){return new u(c.select(t),e)};c.select=function(t){return"string"==typeof t?document.querySelectorAll(t)[0]:t.length?t[0]:t},c.math={},c.math.operator=function(t){return function(e){return e=[].concat(e),e.map(function(e){var i=(""+e).match(/-?[0-9\.]+(.+)/),n=parseFloat(e),s=i&&i[1]||"";return function(i){var r=parseFloat(window.getComputedStyle(this.element).getPropertyValue(i));return isNaN(r)?e:t(r,n)+s}})}},c.math.add=c.math.operator(function(t,e){return t+e}),c.math.subtract=c.math.operator(function(t,e){return t-e}),c.math.multiply=c.math.operator(function(t,e){return t*e}),c.math.divide=c.math.operator(function(t,e){return t/e}),c.defaults={cycle:!1,delay:0,initialDelay:0,duration:500,ease:"in",preserve:!0},c.ease={"in":"ease-in",out:"ease-out","in-out":"ease-in-out",linear:"linear",snap:"cubic-bezier(0,1,.5,1)","ease-in-quad":"cubic-bezier(0.550, 0.085, 0.680, 0.530)","ease-in-cubic":"cubic-bezier(0.550, 0.055, 0.675, 0.190)","ease-in-quart":"cubic-bezier(0.895, 0.030, 0.685, 0.220)","ease-in-quint":"cubic-bezier(0.755, 0.050, 0.855, 0.060)","ease-in-sine":"cubic-bezier(0.470, 0.000, 0.745, 0.715)","ease-in-expo":"cubic-bezier(0.950, 0.050, 0.795, 0.035)","ease-in-circ":"cubic-bezier(0.600, 0.040, 0.980, 0.335)","ease-in-back":"cubic-bezier(0.600, -0.280, 0.735, 0.045)","ease-out-quart":"cubic-bezier(0.165, 0.840, 0.440, 1.000)","ease-out-quint":"cubic-bezier(0.230, 1.000, 0.320, 1.000)","ease-out-sine":"cubic-bezier(0.390, 0.575, 0.565, 1.000)","ease-out-expo":"cubic-bezier(0.190, 1.000, 0.220, 1.000)","ease-out-circ":"cubic-bezier(0.075, 0.820, 0.165, 1.000)","ease-out-back":"cubic-bezier(0.175, 0.885, 0.320, 1.275)","ease-out-quad":"cubic-bezier(0.455, 0.030, 0.515, 0.955)","ease-out-cubic":"cubic-bezier(0.645, 0.045, 0.355, 1.000)","ease-in-out-quart":"cubic-bezier(0.770, 0.000, 0.175, 1.000)","ease-in-out-quint":"cubic-bezier(0.860, 0.000, 0.070, 1.000)","ease-in-out-sine":"cubic-bezier(0.445, 0.050, 0.550, 0.950)","ease-in-out-expo":"cubic-bezier(1.000, 0.000, 0.000, 1.000)","ease-in-out-circ":"cubic-bezier(0.785, 0.135, 0.150, 0.860)","ease-in-out-back":"cubic-bezier(0.680, -0.550, 0.265, 1.550)"},t.proparty=t.pp=c}(this);